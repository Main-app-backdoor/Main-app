name: Code Analysis
on:
  push:
  pull_request:
jobs:
  analyze_cpp:
    runs-on: ubuntu-22.04
    steps:
      - name: Check out code
        uses: actions/checkout@v3
      - name: Install Cppcheck
        run: sudo apt-get update && sudo apt-get install -y cppcheck
      - name: Run Cppcheck
        uses: tonybaloney/cppcheck-action@master
        with:
          args: --enable=all .
      - name: Install Clang-Tidy
        run: sudo apt-get install -y clang-tidy
      - name: Run Clang-Tidy
        run: clang-tidy --quiet $(find . -name '*.cpp' -o -name '*.cxx' -o -name '*.cc') -- -I.
  analyze_swift:
    runs-on: ubuntu-22.04
    steps:
      - name: Check out code
        uses: actions/checkout@v3
      - name: Run SwiftLint
        uses: norio-nomura/action-swiftlint@master
        with:
          args: --reporter github-actions-logging .
  analyze_infer:
    runs-on: ubuntu-22.04
    steps:
      - name: Check out code
        uses: actions/checkout@v3
      - name: Install Infer
        run: |
          sudo apt-get update
          sudo apt-get install -y infer
      - name: Run Infer
        run: infer run -- make